<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.2">
<meta name="author" content="Vincent Devillers">
<title>Mandrel</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="book">
<div id="header">
<h1>Mandrel</h1>
<div class="details">
<span id="author" class="author">Vincent Devillers</span><br>
<span id="email" class="email"><a href="https://twitter.com/treydone">@Treydone</a></span><br>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">This document is under active development</div>
<div class="paragraph">
<p>If you find errors or omissions in this document, please don&#8217;t hesitate to submit an issue or open a pull request with a fix.
New contributors are always welcome!</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Mandrel is a distributed mining engine built for the cloud. Features include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Distributed and Highly Available mining Engine.</p>
</li>
<li>
<p>Powerful and customizable</p>
</li>
<li>
<p>HTTP RESTful API</p>
</li>
<li>
<p>Open Source under the Apache License, version 2 ("ALv2")</p>
</li>
</ul>
</div>
</div>
</div>
<h1 id="_introduction" class="sect0">Introduction</h1>
<div class="sect1">
<h2 id="_what_is_mandrel">What is Mandrel?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mandrel is designed as a whole product, with the idea of bringing a complete mining engine solution that runs out of the box.</p>
</div>
<div class="sect2">
<h3 id="_the_big_picture">The Big Picture</h3>
<div class="paragraph">
<p>Mandrel is designed for performance and scalability. Event if it has been tested on small and on medium-sized cluster (~30 nodes), Mandrel can scale on cloud-sized cluster without any effort.</p>
</div>
<div class="paragraph">
<p>Mandrel is NOT:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>a search engine (but you can use Elasticsearch or Solr -or whatever you want- as output)</p>
</li>
<li>
<p>a NoSQL database</p>
</li>
<li>
<p>a SDK</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_what_for">What for?</h3>
<div class="paragraph">
<p>Mandrel can be used to build various mining jobs:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Web crawlers: make the web your in-house database by turning web pages into data</p>
</li>
<li>
<p>SEO analytics: test web pages and links for valid syntax and structure, find broken links and 404 pages</p>
</li>
<li>
<p>Monitor sites to see when their structure or contents change</p>
</li>
<li>
<p>Build a special-purpose search index, intranet/extranet indexation&#8230;&#8203;</p>
</li>
<li>
<p>Maintain mirror sites for popular Web sites</p>
</li>
<li>
<p>Search for copyright infringements: find duplicate of content</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_compared_to">Compared to&#8230;&#8203;</h3>
<div class="sect3">
<h4 id="_nutch">Nutch</h4>
<div class="paragraph">
<p>Heavy batchs, recrawling seems complicated</p>
</div>
</div>
<div class="sect3">
<h4 id="_heristrix">Heristrix</h4>
<div class="paragraph">
<p>Powerful job definition
No GUI</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_internals">Internals</h3>
<div class="paragraph">
<p>Mandrel uses Zookeeper, Thrift, Netty, Undertow and Spring. It can be connected to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Mongo</p>
</li>
<li>
<p>Kafka</p>
</li>
<li>
<p>Cassandra</p>
</li>
<li>
<p>Hbase + HDFS</p>
</li>
<li>
<p>"Insert your favorite database here"</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<h1 id="_quick_start" class="sect0">Quick Start</h1>
<div class="sect1">
<h2 id="_getting_started">Getting Started</h2>
<div class="sectionbody">
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
A useful tip
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_system_requirements">System Requirements</h3>
<div class="paragraph">
<p>Mandrel works on Linux, Mac and Windows. All you need is Java 8.</p>
</div>
</div>
</div>
</div>
<h1 id="_setup" class="sect0">Setup</h1>
<div class="sect1">
<h2 id="_installation">Installation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_from_the_sources">From the sources</h3>
<div class="paragraph">
<p>Mandrel uses Maven for its build system. Simply run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>mvn clean package -DskipTests
cd standalone
mvn spring:boot run -DskipTests</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_install_with_yum">Install with yum</h3>
<div class="paragraph">
<p>To install Mandrel on Fedora or other RPM-based systems:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a terminal</p>
</li>
<li>
<p>Run the installation command</p>
<div class="dlist">
<dl>
<dt class="hdlist1">Fedora 21 or earlier</dt>
<dd>
<div class="literalblock">
<div class="content">
<pre>$ sudo yum install mandrel</pre>
</div>
</div>
</dd>
<dt class="hdlist1">Fedora 22 or later</dt>
<dd>
<div class="literalblock">
<div class="content">
<pre>$ sudo dnf install mandrel</pre>
</div>
</div>
</dd>
</dl>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_install_with_apt_get">Install with apt-get</h3>
<div class="paragraph">
<p>To install Mandrel on Debian Sid or Ubuntu Saucy or greater:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Open a terminal</p>
</li>
<li>
<p>Type the apt-get command</p>
<div class="literalblock">
<div class="content">
<pre>$ sudo apt-get install mandrel</pre>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration">Configuration</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_common">Common</h3>
<div class="sect3">
<h4 id="_discovery">Discovery</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>discovery:
  instanceHost: localhost
  zookeeper:
    enabled: true
    connectString: localhost:2181
    root: /mandrel</code></pre>
</div>
</div>
<div id="discovery.instanceHost" class="dlist">
<dl>
<dt class="hdlist1"><strong><code>discovery.instanceHost</code></strong></dt>
<dd>
<div class="paragraph">
<div class="title">Description</div>
<p>The address what will be registered in the discovery.</p>
</div>
<div class="paragraph">
<div class="title">Default</div>
<p><code>localhost</code></p>
</div>
</dd>
</dl>
</div>
<div id="discovery.zookeeper.connectString" class="dlist">
<dl>
<dt class="hdlist1"><strong><code>discovery.zookeeper.connectString</code></strong></dt>
<dd>
<div class="paragraph">
<div class="title">Description</div>
<p>Comma separated list of servers in the ZooKeeper ensemble.
    For example, "host1.mydomain.com,host2.mydomain.com,host3.mydomain.com".
    By default this is set to localhost for local and pseudo-distributed modes
    of operation. For a fully-distributed setup, this should be set to a full
    list of ZooKeeper ensemble servers.</p>
</div>
<div class="paragraph">
<div class="title">Default</div>
<p><code>localhost:2181</code></p>
</div>
</dd>
</dl>
</div>
<div id="discovery.zookeeper.root" class="dlist">
<dl>
<dt class="hdlist1"><strong><code>discovery.zookeeper.root</code></strong></dt>
<dd>
<div class="paragraph">
<div class="title">Description</div>
<p>The root path in Zookeeper where the services will be registered.</p>
</div>
<div class="paragraph">
<div class="title">Default</div>
<p><code>/mandrel</code></p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_transport">Transport</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>transport:
  bindAddress: localhost
  port: 8090</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_logging">Logging</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>logging:
  console:
    enabled: true
    level: WARN
  level:
    org.springframework: INFO
    io.mandrel: DEBUG
    io.mandrel.messaging: DEBUG</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_controller_yml">controller.yml</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>server:
  port: 8080
  undertow:
    buffer-size: 16000
    buffers-per-region: 20
    direct-buffers: true
    io-threads: 4
    worker-threads: 32</code></pre>
</div>
</div>
<div id="server.port" class="dlist">
<dl>
<dt class="hdlist1"><strong><code>server.port</code></strong></dt>
<dd>
<div class="paragraph">
<div class="title">Description</div>
<p>The port used for all HTTP incoming traffic.</p>
</div>
<div class="paragraph">
<div class="title">Default</div>
<p><code>8080</code></p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_frontier_yml">frontier.yml</h3>

</div>
<div class="sect2">
<h3 id="_worker_yml">worker.yml</h3>

</div>
<div class="sect2">
<h3 id="_standalone_yml">standalone.yml</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>spring:
  pidfile: standalone.pid
  application:
    name: standalone
    admin:
      enabled: false
  data:
    mongodb:
      uri: mongodb://localhost:27017/mandrel
  jmx:
    enabled: false
discovery:
  local:
    enabled: true
  zookeeper:
    enabled: false</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_running_modes">Running modes</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_standalone_single_jvm">Standalone - Single-JVM</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>discovery:
  local:
    enabled: true
  zookeeper:
    enabled: false</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mandrel-standalone start</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mandrel-standalone stop</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_standalone_pseudo_distributed">Standalone - Pseudo-distributed</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>discovery:
  zookeeper:
    enabled: true</code></pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mandrel-standalone start</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mandrel-standalone stop</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_distributed">Distributed</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ mandrel-controller start
$ mandrel-frontier start
$ mandrel-worker start</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ mandrel-worker start
$ mandrel-frontier start
$ mandrel-controller stop</code></pre>
</div>
</div>
</div>
</div>
</div>
<h1 id="_architecture" class="sect0">Architecture</h1>
<div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_components">Components</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_controller">Controller</h3>

</div>
<div class="sect2">
<h3 id="_frontier">Frontier</h3>
<div class="paragraph">
<p>The goal of the frontier is to know which URI to process next, and when. The frontier decides the logic and policies to follow when a crawler is visiting sources like websites: what pages should be crawled next, priorities and ordering, how often pages are revisited, etc.
It keeps the state of the crawl. This includes, but is not limited to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>What URIs have been discovered</p>
</li>
<li>
<p>What URIs are being processed (fetched)</p>
</li>
<li>
<p>What URIs have been processed</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The frontier garanties the respect of the politeness like the bandwidth limits or the number of pages to be crawled.</p>
</div>
<div class="paragraph">
<p>The frontier is set of various background tasks:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Priorizer: from a set of URIs, schedule the priority of the URIs and push them in the internal queues</p>
</li>
<li>
<p>Revister: revist a page, when and how</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_revisit_policies">Revisit policies</h4>
<div class="ulist">
<ul>
<li>
<p>Freshness: This is a binary measure that indicates whether the local copy is accurate or not.</p>
</li>
<li>
<p>Age: This is a measure that indicates how outdated the local copy is.</p>
</li>
<li>
<p>Uniform policy: This involves re-visiting all pages in the collection with the same frequency, regardless of their rates of change.</p>
</li>
<li>
<p>Proportional policy: This involves re-visiting more often the pages that change more frequently. The visiting frequency is directly proportional to the (estimated) change frequency.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_politeness">Politeness</h4>
<div class="ulist">
<ul>
<li>
<p>Parallel connections</p>
</li>
<li>
<p>Max pages per second</p>
</li>
<li>
<p>Max bytes per second/bandwidth</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_worker">Worker</h3>
<div class="ulist">
<ul>
<li>
<p>Pick out a uri from the frontier</p>
</li>
<li>
<p>Fetch the content</p>
</li>
<li>
<p>Store raw results in blobstore</p>
</li>
<li>
<p>Find links in the content</p>
</li>
<li>
<p>Store metadata in metadatastore</p>
</li>
<li>
<p>If extraction needed, parse the content and store the results in documentstore</p>
</li>
<li>
<p>Push some infos back to the frontier</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scalabilty">Scalabilty</h2>
<div class="sectionbody">

</div>
</div>
<h1 id="_using_mandrel" class="sect0">Using Mandrel</h1>
<div class="sect1">
<h2 id="_web_ui">Web UI</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_api_rest">API REST</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_api_conventions">API Conventions</h3>

</div>
<div class="sect2">
<h3 id="_endpoints">Endpoints</h3>
<div class="sect3">
<h4 id="_spiders">Spiders</h4>
<div id="spiders" class="dlist">
<dl>
<dt class="hdlist1"><strong><code>/spiders</code></strong></dt>
<dd>
<div class="paragraph">
<div class="title">Description</div>
<p>List all the spider</p>
</div>
</dd>
</dl>
</div>
<div id="spiders_id" class="dlist">
<dl>
<dt class="hdlist1"><strong><code>/spiders/{id}</code></strong></dt>
<dd>
<div class="paragraph">
<div class="title">Description</div>
<p>Return a spider</p>
</div>
</dd>
</dl>
</div>
<div id="spiders_start" class="dlist">
<dl>
<dt class="hdlist1"><strong><code>/spiders/{id}/start</code></strong></dt>
<dd>
<div class="paragraph">
<div class="title">Description</div>
<p>Start</p>
</div>
</dd>
</dl>
</div>
<div id="spiders_stop" class="dlist">
<dl>
<dt class="hdlist1"><strong><code>/spiders/{id}/stop</code></strong></dt>
<dd>
<div class="paragraph">
<div class="title">Description</div>
<p>Stop</p>
</div>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_data">Data</h4>

</div>
<div class="sect3">
<h4 id="_cluster">Cluster</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_spider_definition">Spider definition</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_filtering">Filtering</h3>
<div class="paragraph">
<p>You can add filters to your spider. There are two types of filters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>link filters</p>
</li>
<li>
<p>blob filters</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Link filters apply conditions only on the link whereas blob filters apply conditions on the downloaded blob. This means also that link filters are applied BEFORE the crawling and blob filters AFTER. Take this in consideration when developping new spiders</p>
</div>
<div class="sect3">
<h4 id="_link_filters">Link filters</h4>
<div class="paragraph">
<p><strong>Domains</strong></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type":"allowed_for_domains",
    "domains": [
        "mydomain1",
        "mydomain2"
    ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Skip ancor</strong></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type":"skip_ancor"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Pattern</strong></p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type":"pattern",
    "pattern": "..."
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Sanitize</strong></p>
</div>
<div class="paragraph">
<p>Remove all the parameters in a URI (tck=&#8230;&#8203;, timestamp=&#8230;&#8203;, adsclick=&#8230;&#8203;)</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type":"sanitize_params"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Booleans</strong></p>
</div>
<div class="paragraph">
<p>or|and|not|true|false</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "not": {
      "type":"allowed_for_domains",
      "domains": [
          "mydomain1",
          "mydomain2"
      ]
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
  "and": [
      {
          "type":"allowed_for_domains",
          "domains": [
              "mydomain1",
              "mydomain2"
          ]
      },
      {
          "type":"pattern",
          "pattern": "..."
      }
  ]
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To be continued&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Keep only some parameters</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_blob_filters">Blob filters</h4>
<div class="paragraph">
<p><strong>Size</strong></p>
</div>
<div class="paragraph">
<p><strong>Booleans</strong></p>
</div>
<div class="paragraph">
<p>or|and|not|true|false</p>
</div>
<div class="paragraph">
<p>To be continued&#8230;&#8203;</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_raw_exporting">Raw exporting</h3>
<div class="paragraph">
<p>Your spider is now done. Or not. We don&#8217;t care, we just want to export the raw data of the pages/documents. You have to two ways to do this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Extract the data from the page store if you have specified one during the creation (SQL, Cassandra&#8230;&#8203;)</p>
</li>
<li>
<p>Use the dedicated endpoint</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ curl -X GET http://localhost:8080/spiders/wikipedia/raw/export?format=csv|json</code></pre>
</div>
</div>
<div class="paragraph">
<p>To be continued&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Define options for the exporters</p>
</li>
<li>
<p>Add formats for parquet</p>
</li>
<li>
<p>Support compression</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_extracting">Extracting</h3>
<div class="paragraph">
<p>Somethimes we want to crawl pages. But what we really want is the data INSIDE the pages.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ curl -X POST http://localhost:8080/spiders/imdb -d '
{
   "sources":[
      {
         "type":"fixed",
         "urls":[
            "http://www.imdb.com/"
         ]
      }
   ],
   "extractors":[
      {
         "name":"movie_extractor"
         "filters":[
            {
               "type":"patterns",
               "value":[
                  "/title"
               ]
            }
         ],
         "fields":[
            {
               "title":{
                  "extractor":{
                     "type":"xpath",
                     "value":"//*[@id="overview-top"]/h1/span[1]/text()",
                     "source":"body"
                  }
               }
            },
            {
               "description":{
                  "extractor":{
                     "type":"xpath",
                     "value":"//*[@id="overview-top"]/p[2]/text()",
                     "source":"body"
                  }
               }
            },
            {
               "actors":{
                  "extractor":{
                     "type":"xpath",
                     "value":"//*[@id="overview-top"]/div[6]/a/span",
                     "source":"body"
                  }
               }
            }
         ]
      }
   ]
}
'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will extract the fields 'title', 'description' and 'actors' from the page.</p>
</div>
</div>
<div class="sect2">
<h3 id="_data_exporting">Data exporting</h3>
<div class="paragraph">
<p>Ok, now we got some data, we can export them by calling:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>$ curl -X POST http://localhost:8080/spiders/export/movie_extractor?format=csv|json</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="_json">JSON</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type":"json"
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_delimited_separated_values">Delimited separated values</h4>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
    "type":"csv",
    "quote_char":"\"",
    "delimiter_values":44,
    "delimiter_multivalues":124,
    "keep_only_first_value":false,
    "add_header":true,
    "end_of_line_symbols":"\r\n"
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stores">Stores</h3>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
   "stores":{
      "metadata":{
         "type":"internal"
      },
      "page":{
         "type":"internal"
      }
   }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
   "stores":{
      "metadata":{
         "type":"internal"
      },
      "page":null
   }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_client">Client</h3>
<div class="paragraph">
<p>Each spider can be configured with a specified HTTP client in order to configure:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Proxies</p>
</li>
<li>
<p>Request and connection timeouts</p>
</li>
<li>
<p>User-agent generation</p>
</li>
<li>
<p>Custom cookies (jsessionid&#8230;&#8203;) and headers (X-Request-By, Basic-Authentication&#8230;&#8203;)</p>
</li>
<li>
<p>DNS resolution strategies</p>
</li>
<li>
<p>Politeness</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>{
 "request_time_out":3000,
 "headers":null,
 "params":null,
 "follow_redirects":false,
 "cookies":null,
 "user_agent_provisionner":{
     "type":"fixed",
     "ua":"Mandrel"
 },
 "dns_cache":{
     "type":"internal"
 },
 "proxy":{
     "type":"no"
 },
 "politeness":{
     "global_rate":1000,
     "per_node_rate":500,
     "max_pages":500,
     "wait":100,
     "ignore_robots_txt":false,
     "recrawl_after":-1
 }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_security">Security</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="_production_considerations_performance_tuning">Production considerations &amp; performance tuning</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Section pending
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, Mandrel is started in a standalone mode. In this mode, the 3 main components are started in the same JVM. Altought this may be useful for testing purposes, the standalone mode does not allow you to scale your deployment.</p>
</div>
<div class="paragraph">
<p>For production, we recommand you to deploy at least one controller, one frontier and one worker, each in separate JVM on a dedicated serveur.</p>
</div>
<div class="sect2">
<h3 id="_general_guidelines">General Guidelines</h3>

</div>
<div class="sect2">
<h3 id="_operating_system">Operating System</h3>
<div class="sect3">
<h4 id="_64_bit">64-bit</h4>
<div class="paragraph">
<p>Use a 64-bit platform (and 64-bit JVM).</p>
</div>
</div>
<div class="sect3">
<h4 id="_swapping">Swapping</h4>
<div class="paragraph">
<p>Watch out for swapping. Set swappiness to 0.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_network">Network</h3>

</div>
<div class="sect2">
<h3 id="_java">Java</h3>

</div>
<div class="sect2">
<h3 id="_zookeeper">ZooKeeper</h3>

</div>
<div class="sect2">
<h3 id="_case_studies">Case studies</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_troubleshooting">Troubleshooting</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Section pending
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_glossary">Glossary</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Section pending
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_copyright_and_license">Copyright and License</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Section pending
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This software is licensed under the Apache License, version 2 ("ALv2"), quoted below.</p>
</div>
<div class="paragraph">
<p>Copyright 2009-2016 Mandrel</p>
</div>
<div class="paragraph">
<p>Licensed under the Apache License, Version 2.0 (the "License"); you may not
use this file except in compliance with the License. You may obtain a copy of
the License at</p>
</div>
<div class="literalblock">
<div class="content">
<pre>http://www.apache.org/licenses/LICENSE-2.0</pre>
</div>
</div>
<div class="paragraph">
<p>Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
License for the specific language governing permissions and limitations under
the License.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-01-19 09:15:05 +01:00
</div>
</div>
</body>
</html>